!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("echarts")):"function"==typeof define&&define.amd?define(["echarts"],t):"object"==typeof exports?exports["echarts-liquidfill"]=t(require("echarts")):e["echarts-liquidfill"]=t(e.echarts)}(this,function(e){return function(e){function t(n){if(r[n])return r[n].exports;var a=r[n]={exports:{},id:n,loaded:!1};return e[n].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){e.exports=r(6)},function(t,r){t.exports=e},function(e,t,r){function n(e,t,r,n){if(!t)return e;var l=a(t[0]),u=i.isArray(l)&&l.length||1;r=r||[],n=n||"extra";for(var c=0;c<u;c++)if(!e[c]){var s=r[c]||n+(c-r.length);e[c]=o(t,c)?{type:"ordinal",name:s}:s}return e}function a(e){return i.isArray(e)?e:i.isObject(e)?e.value:e}var i=r(5),o=n.guessOrdinal=function(e,t){for(var r=0,n=e.length;r<n;r++){var o=a(e[r]);if(!i.isArray(o))return!1;var o=o[t];if(null!=o&&isFinite(o))return!1;if(i.isString(o)&&"-"!==o)return!0}return!1};e.exports=n},function(e,t){function r(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}var n={},a=1e-4;n.linearMap=function(e,t,r,n){var a=t[1]-t[0],i=r[1]-r[0];if(0===a)return 0===i?r[0]:(r[0]+r[1])/2;if(n)if(a>0){if(e<=t[0])return r[0];if(e>=t[1])return r[1]}else{if(e>=t[0])return r[0];if(e<=t[1])return r[1]}else{if(e===t[0])return r[0];if(e===t[1])return r[1]}return(e-t[0])/a*i+r[0]},n.parsePercent=function(e,t){switch(e){case"center":case"middle":e="50%";break;case"left":case"top":e="0%";break;case"right":case"bottom":e="100%"}return"string"==typeof e?r(e).match(/%$/)?parseFloat(e)/100*t:parseFloat(e):null==e?NaN:+e},n.round=function(e,t){return null==t&&(t=10),t=Math.min(Math.max(0,t),20),+(+e).toFixed(t)},n.asc=function(e){return e.sort(function(e,t){return e-t}),e},n.getPrecision=function(e){if(e=+e,isNaN(e))return 0;for(var t=1,r=0;Math.round(e*t)/t!==e;)t*=10,r++;return r},n.getPrecisionSafe=function(e){var t=e.toString(),r=t.indexOf(".");return r<0?0:t.length-1-r},n.getPixelPrecision=function(e,t){var r=Math.log,n=Math.LN10,a=Math.floor(r(e[1]-e[0])/n),i=Math.round(r(Math.abs(t[1]-t[0]))/n);return Math.max(-a+i,0)},n.MAX_SAFE_INTEGER=9007199254740991,n.remRadian=function(e){var t=2*Math.PI;return(e%t+t)%t},n.isRadianAroundZero=function(e){return e>-a&&e<a},n.parseDate=function(e){if(e instanceof Date)return e;if("string"==typeof e){var t=new Date(e);return isNaN(+t)&&(t=new Date(new Date(e.replace(/-/g,"/"))-new Date("1970/01/01"))),t}return new Date(Math.round(e))},n.quantity=function(e){return Math.pow(10,Math.floor(Math.log(e)/Math.LN10))},n.nice=function(e,t){var r,a=n.quantity(e),i=e/a;return r=t?i<1.5?1:i<2.5?2:i<4?3:i<7?5:10:i<1?1:i<2?2:i<3?3:i<5?5:10,r*a},e.exports=n},function(e,t){e.exports=function(e,t){var r={};t.eachRawSeriesByType(e,function(e){var n=e.getRawData(),a={};if(!t.isSeriesFiltered(e)){var i=e.getData();i.each(function(e){var t=i.getRawIndex(e);a[t]=e}),n.each(function(t){var o=n.getItemModel(t),l=a[t],u=null!=l&&i.getItemVisual(l,"color",!0);if(u)n.setItemVisual(t,"color",u);else{var c=o.get("itemStyle.normal.color")||e.getColorFromPalette(n.getName(t),r);n.setItemVisual(t,"color",c),null!=l&&i.setItemVisual(l,"color",c)}})}})}},function(e,t){function r(e){if("object"==typeof e&&null!==e){var t=e;if(e instanceof Array){t=[];for(var n=0,a=e.length;n<a;n++)t[n]=r(e[n])}else if(!P(e)&&!S(e)){t={};for(var i in e)e.hasOwnProperty(i)&&(t[i]=r(e[i]))}return t}return e}function n(e,t,a){if(!I(t)||!I(e))return a?r(t):e;for(var i in t)if(t.hasOwnProperty(i)){var o=e[i],l=t[i];!I(l)||!I(o)||w(l)||w(o)||S(l)||S(o)||P(l)||P(o)?!a&&i in e||(e[i]=r(t[i],!0)):n(o,l,a)}return e}function a(e,t){for(var r=e[0],a=1,i=e.length;a<i;a++)r=n(r,e[a],t);return r}function i(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}function o(e,t,r){for(var n in t)t.hasOwnProperty(n)&&(r?null!=t[n]:null==e[n])&&(e[n]=t[n]);return e}function l(){return document.createElement("canvas")}function u(){return L||(L=W.createCanvas().getContext("2d")),L}function c(e,t){if(e){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r}return-1}function s(e,t){function r(){}var n=e.prototype;r.prototype=t.prototype,e.prototype=new r;for(var a in n)e.prototype[a]=n[a];e.prototype.constructor=e,e.superClass=t}function f(e,t,r){e="prototype"in e?e.prototype:e,t="prototype"in t?t.prototype:t,o(e,t,r)}function h(e){if(e)return"string"!=typeof e&&"number"==typeof e.length}function p(e,t,r){if(e&&t)if(e.forEach&&e.forEach===O)e.forEach(t,r);else if(e.length===+e.length)for(var n=0,a=e.length;n<a;n++)t.call(r,e[n],n,e);else for(var i in e)e.hasOwnProperty(i)&&t.call(r,e[i],i,e)}function d(e,t,r){if(e&&t){if(e.map&&e.map===N)return e.map(t,r);for(var n=[],a=0,i=e.length;a<i;a++)n.push(t.call(r,e[a],a,e));return n}}function g(e,t,r,n){if(e&&t){if(e.reduce&&e.reduce===V)return e.reduce(t,r,n);for(var a=0,i=e.length;a<i;a++)r=t.call(n,r,e[a],a,e);return r}}function v(e,t,r){if(e&&t){if(e.filter&&e.filter===T)return e.filter(t,r);for(var n=[],a=0,i=e.length;a<i;a++)t.call(r,e[a],a,e)&&n.push(e[a]);return n}}function y(e,t,r){if(e&&t)for(var n=0,a=e.length;n<a;n++)if(t.call(r,e[n],n,e))return e[n]}function m(e,t){var r=q.call(arguments,2);return function(){return e.apply(t,r.concat(q.call(arguments)))}}function x(e){var t=q.call(arguments,1);return function(){return e.apply(this,t.concat(q.call(arguments)))}}function w(e){return"[object Array]"===A.call(e)}function M(e){return"function"==typeof e}function b(e){return"[object String]"===A.call(e)}function I(e){var t=typeof e;return"function"===t||!!e&&"object"==t}function P(e){return!!j[A.call(e)]}function S(e){return e&&1===e.nodeType&&"string"==typeof e.nodeName}function C(e){for(var t=0,r=arguments.length;t<r;t++)if(null!=arguments[t])return arguments[t]}function F(){return Function.call.apply(q,arguments)}function D(e,t){if(!e)throw new Error(t)}var L,j={"[object Function]":1,"[object RegExp]":1,"[object Date]":1,"[object Error]":1,"[object CanvasGradient]":1,"[object CanvasPattern]":1,"[object Image]":1},A=Object.prototype.toString,E=Array.prototype,O=E.forEach,T=E.filter,q=E.slice,N=E.map,V=E.reduce,W={inherits:s,mixin:f,clone:r,merge:n,mergeAll:a,extend:i,defaults:o,getContext:u,createCanvas:l,indexOf:c,slice:F,find:y,isArrayLike:h,each:p,map:d,reduce:g,filter:v,bind:m,curry:x,isArray:w,isString:b,isObject:I,isFunction:M,isBuildInObject:P,isDom:S,retrieve:C,assert:D,noop:function(){}};e.exports=W},function(e,t,r){var n=r(1);r(8),r(9),n.registerVisual(n.util.curry(r(4),"liquidFill"))},function(e,t,r){function n(e,t,r,n){return 0===t?[[e+.5*r/Math.PI/2,n/2],[e+.5*r/Math.PI,n],[e+r/4,n]]:1===t?[[e+.5*r/Math.PI/2*(Math.PI-2),n],[e+.5*r/Math.PI/2*(Math.PI-1),n/2],[e+r/4,0]]:2===t?[[e+.5*r/Math.PI/2,-n/2],[e+.5*r/Math.PI,-n],[e+r/4,-n]]:[[e+.5*r/Math.PI/2*(Math.PI-2),-n],[e+.5*r/Math.PI/2*(Math.PI-1),-n/2],[e+r/4,0]]}var a=r(1);e.exports=a.graphic.extendShape({type:"ec-liquid-fill",shape:{waveLength:0,radius:0,cx:0,cy:0,waterLevel:0,amplitude:0,borderWidth:0,borderDistance:0,phase:0,inverse:!1},style:{fill:"#0f0"},buildPath:function(e,t){for(var r=2*Math.ceil(2*t.radius/t.waveLength*4);t.phase<2*-Math.PI;)t.phase+=2*Math.PI;for(;t.phase>0;)t.phase-=2*Math.PI;var a=t.phase/Math.PI/2*t.waveLength,i=t.cx-t.radius+a-2*t.radius;e.moveTo(i,t.waterLevel);for(var o=0,l=0;l<r;++l){var u=l%4,c=n(l*t.waveLength/4,u,t.waveLength,t.amplitude);e.bezierCurveTo(c[0][0]+i,-c[0][1]+t.waterLevel,c[1][0]+i,-c[1][1]+t.waterLevel,c[2][0]+i,-c[2][1]+t.waterLevel),l===r-1&&(o=c[2][0])}t.inverse?(e.lineTo(o+i,t.cy-t.radius),e.lineTo(i,t.cy-t.radius),e.lineTo(i,t.waterLevel)):(e.lineTo(o+i,t.cy+t.radius),e.lineTo(i,t.cy+t.radius),e.lineTo(i,t.waterLevel)),e.closePath()}})},function(e,t,r){var n=r(2),a=r(1);a.extendSeriesModel({type:"series.liquidFill",visualColorAccessPath:"textStyle.normal.color",optionUpdated:function(){var e=this.option;e.gridSize=Math.max(Math.floor(e.gridSize),4)},getInitialData:function(e,t){var r=n(["value"],e.data),i=new a.List(r,this);return i.initData(e.data),i},defaultOption:{color:["#294D99","#156ACF","#1598ED","#45BDFF"],center:["50%","50%"],radius:"50%",amplitude:20,waveLength:"80%",phase:"auto",period:"auto",direction:"right",animationEasing:"linear",animationEasingUpdate:"linear",animationDuration:2e3,animationDurationUpdate:1e3,outline:{borderDistance:8,itemStyle:{borderColor:"#294D99",borderWidth:8,shadowBlur:20,shadowColor:"rgba(0, 0, 0, 0.25)"}},itemStyle:{normal:{backgroundColor:"#E3F7FF",opacity:.95,shadowBlur:50,shadowColor:"rgba(0, 0, 0, 0.4)"},emphasis:{opacity:.8}},label:{normal:{show:!0,textStyle:{color:"#294D99",insideColor:"#fff",fontSize:50,fontWeight:"bold"},textAlign:"center",textVerticalAlign:"middle",shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.25)"},emphasis:{textStyle:{color:"#156ACF",insideColor:"#E3F7FF",fontSize:50,fontWeight:"bold"}}}}})},function(e,t,r){var n=r(1),a=r(3),i=a.parsePercent,o=r(7);n.extendChartView({type:"liquidFill",render:function(e,t,r){function a(){var t=e.getModel("outline.itemStyle").getItemStyle(),r=e.get("itemStyle.normal.backgroundColor");return t.fill=r,t.lineWidth=0,new n.graphic.Circle({shape:{cx:M,cy:b,r:d},style:t})}function l(e,t,r){var a=f.getItemModel(e),i=a.getModel("itemStyle"),l=a.get("phase"),u=a.get("amplitude"),c=f.get("value",e),s=d-c*d*2;l=r?r.shape.phase:"auto"===l?e*Math.PI/4:l;var h=i.getModel("normal").getItemStyle();h.fill=f.getItemVisual(e,"color");var p=2*d,g=new o({shape:{waveLength:D,radius:d,cx:p,cy:0,waterLevel:s,amplitude:u,borderWidth:v,borderDistance:S,phase:l,inverse:t},style:h,position:[M,b]});g.shape._waterLevel=s;var y=i.getModel("emphasis").getItemStyle();return y.lineWidth=0,n.graphic.setHoverStyle(g,y),g.setClipPath(new n.graphic.Circle({shape:{cx:0,cy:0,r:d}})),g}function u(e,t,r){var n=f.getItemModel(e),a=n.get("period"),i=n.get("direction"),o=f.get("value",e),l=(f.get("value",0),n.get("phase"));l=r?r.shape.phase:"auto"===l?e*Math.PI/4:l;var u=function(t){var r=f.count();return 0===r?t:t*(.2+(r-e)/r*.8)},c=0;c="auto"===a?u(5e3):"function"==typeof a?a(o,e):a;var s=0;"right"===i||void 0==i?s=Math.PI:"left"===i?s=-Math.PI:"none"===i?s=0:console.error("Illegal direction value for liquid fill."),t.animate().stop(),"none"!==i&&t.animate("shape",!0).when(0,{phase:l}).when(c/2,{phase:s+l}).when(c,{phase:2*s+l}).during(function(){C&&C.dirty(!0)}).start()}function c(e){function t(){var e=f.get("value",0),t=r.get("formatter");if(!t)return Math.ceil(100*e)+"%";if("string"==typeof t)return t.replace("{value}",e||"");if("function"==typeof t){for(var n=[],a=0;a<f._rawData.length;++a)n.push(f.get("value",a));return t(n)}}var r=h.getModel("label.normal"),a=h.getModel("label.emphasis"),i=r.getModel("textStyle"),o=a.getModel("textStyle"),l=r.getItemStyle();Object.assign(l,{text:t(),x:M,y:b,fill:i.get("color"),textAlign:r.get("textAlign"),textVerticalAlign:r.get("textVerticalAlign"),textFont:i.getFont()});var u=new n.graphic.Text({style:l}),c=Object.assign({},l);c.fill=i.get("insideColor");var s=new n.graphic.Text({style:c}),p=Object.assign({},l);p.fill=o.get("color"),p.textFont=o.getFont(),u.hoverStyle=p;var g=Object.assign({},l);g.fill=o.get("insideColor"),g.textFont=o.getFont(),s.hoverStyle=g;var v=new n.graphic.Circle({shape:{cx:0,cy:0,r:d}});C=new n.graphic.CompoundPath({shape:{paths:e},position:[M,b]}),C.setClipPath(v),s.setClipPath(C),s.z2=10,u.z2=10;var y=new n.graphic.Group;return y.add(u),y.add(s),n.graphic.setHoverStyle(y),y}var s=this.group;s.removeAll();var f=e.getData(),h=f.getItemModel(0),p=h.get("center"),d=h.get("radius"),g=e.get("outline.itemStyle.borderColor"),v=e.get("outline.itemStyle.borderWidth"),y=e.get("outline.borderDistance"),m=r.getWidth(),x=r.getHeight(),w=Math.min(m,x),M=i(p[0],m),b=i(p[1],x),v=i(v,w),I=i(d,w)/2,P=I-v,S=i(y,w),C=null,F=new n.graphic.Ring({shape:{cx:M,cy:b,r:P,r0:I},style:{fill:g}});s.add(F),d=P-S;var D=i(h.get("waveLength"),2*d);s.add(a());var L=this._data,j=[];f.diff(L).add(function(t){var r=l(t,!1),a=r.shape.waterLevel;r.shape.waterLevel=d,n.graphic.initProps(r,{shape:{waterLevel:a}},e),u(t,r,null),s.add(r),f.setItemGraphicEl(t,r),j.push(r)}).update(function(t,r){var a=L.getItemGraphicEl(r),i=l(t,!1,a);n.graphic.updateProps(a,{shape:i.shape},e),u(t,a,a),s.add(a),f.setItemGraphicEl(t,a),j.push(a)}).remove(function(e){var t=L.getItemGraphicEl(e);s.remove(t)}).execute(),s.add(c(j)),this._data=f}})}])});